import hashlib
import requests

# Replace with your actual VirusTotal API Key
API_KEY = "Add_Your_API_Key_Here"

def get_file_hash(file_path):
    """Calculate SHA256 hash of the given file."""
    hasher = hashlib.sha256()
    try:
        with open(file_path, "rb") as f:
            while chunk := f.read(4096):
                hasher.update(chunk)
        return hasher.hexdigest()
    except FileNotFoundError:
        return None

def check_virustotal(file_hash):
    """Query VirusTotal for the file hash."""
    url = f"https://www.virustotal.com/api/v3/files/{file_hash}"
    headers = {"x-apikey": API_KEY}
    
    response = requests.get(url, headers=headers)
    
    if response.status_code == 200:
        data = response.json()
        malicious_votes = data["data"]["attributes"]["last_analysis_stats"]["malicious"]
        return malicious_votes
    elif response.status_code == 404:
        return "No match found on VirusTotal."
    else:
        return f"Error: {response.status_code}"

if __name__ == "__main__":
    file_path = input("Enter the file path to scan: ")
    file_hash = get_file_hash(file_path)

    if file_hash:
        print(f"\n🔍 SHA256 Hash: {file_hash}")
        print("🔎 Checking VirusTotal database...")
        result = check_virustotal(file_hash)
        print(f"🔍 VirusTotal Result: {result} malicious detections")
    else:
        print("❌ Error: File not found!")